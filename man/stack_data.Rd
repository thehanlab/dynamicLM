% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/stack_data.R
\name{stack_data}
\alias{stack_data}
\title{Build a stacked dataset from original dataset (wide or long format).}
\usage{
stack_data(
  data,
  outcome,
  lms,
  w,
  covs,
  format = c("wide", "long"),
  id,
  rtime,
  left.open = FALSE
)
}
\arguments{
\item{data}{Data frame from which to construct landmark super dataset}

\item{outcome}{A list with items time and status, containing strings
identifying the names of time and status variables, respectively, of the
survival outcome}

\item{lms}{vector, the value of the landmark time points. This should be a
range of points over the interval that prediction will be made. For
example, if 5-year risk predictions are to be made over the first three
years, this could be \code{c(0, 1.5, 3)}, \code{c(0, 1, 2, 3)} etc.}

\item{w}{Scalar, the value of the prediction window (ie predict risk within
time w landmark points)}

\item{covs}{A list with items fixed and varying, containing character strings
specifying column names in the data containing time-fixed and time-varying
covariates, respectively. If missing, all columns that are not the outcome,
rtime or id column are set to be time-varying covariates.}

\item{format}{Character string specifying whether the original data are in
wide (default) or in long format.}

\item{id}{Character string specifying the column name in data containing the
subject id.}

\item{rtime}{Character string specifying the column name in data containing
the (running) time variable associated with the time-varying variables;
only needed if format = "long".}

\item{left.open}{Boolean (default = FALSE), indicating if the intervals for
the time-varying covariates are open on the left (and closed on the right)
or vice-versa.}
}
\value{
An object of class "LMdataframe". This the following components:
\itemize{
\item data: containing the stacked data set, i.e., the outcome and the values
of time-fixed and time-varying covariates taken at the landmark time
points. The value of the landmark time point is stored in column LM.
\item outcome: same as input
\item w: same as input
\item end_time: final landmarking point used in training
\item lm_col: "LM", identifies the landmark time column.
}
}
\description{
This stacked dataset output is used as input to \code{\link[=dynamic_lm]{dynamic_lm()}} to fit a
landmark supermodel for dynamic prediction. Calling \code{\link[=add_interactions]{add_interactions()}} on
the output before fitting the supermodel allows for landmark time
interactions to be included.
}
\examples{
\dontrun{
data(relapse)
outcome <- list(time = "Time", status = "event")
covars <- list(fixed = c("age.at.time.0", "male", "stage", "bmi"),
               varying = c("treatment"))
w <- 60; lms <- c(0, 6, 12, 18)
# Stack landmark datasets
lmdata <- stack_data(relapse, outcome, lms, w, covars, format = "long",
                     id = "ID", rtime = "T_txgiven")
head(lmdata$data)
}

}
\seealso{
\code{\link[=add_interactions]{add_interactions()}}, \code{\link[=dynamic_lm]{dynamic_lm()}}
}
